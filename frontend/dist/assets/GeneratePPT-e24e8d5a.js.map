{"version":3,"file":"GeneratePPT-e24e8d5a.js","sources":["../../src/utils/jsonValidator.ts","../../src/views/ppt/GeneratePPT.vue"],"sourcesContent":["\r\n/**\r\n * 清理并验证JSON字符串\r\n * @param text 可能包含额外内容的JSON字符串\r\n * @returns 清理后的合法JSON字符串\r\n */\r\nexport function cleanAndValidateJSON(text: string): string {\r\n  // 尝试找到第一个 { 和最后一个 }\r\n  const firstBrace = text.indexOf('{');\r\n  const lastBrace = text.lastIndexOf('}');\r\n  \r\n  if (firstBrace === -1 || lastBrace === -1) {\r\n    throw new Error('No valid JSON object found in the text');\r\n  }\r\n\r\n  // 提取可能的JSON部分\r\n  let jsonCandidate = text.substring(firstBrace, lastBrace + 1);\r\n\r\n  // 移除可能的Markdown代码块标记\r\n  jsonCandidate = jsonCandidate.replace(/```json\\s*|```\\s*$/g, '');\r\n  \r\n  // 尝试解析JSON以验证其有效性\r\n  try {\r\n    JSON.parse(jsonCandidate);\r\n    return jsonCandidate;\r\n  } catch (e) {\r\n    throw new Error(`Invalid JSON format: ${e.message}`);\r\n  }\r\n}\r\n\r\n/**\r\n * 验证PPT内容的数据结构\r\n * @param content PPT内容对象\r\n * @returns boolean\r\n */\r\nexport function validatePPTContent(content: any): boolean {\r\n  if (!content) return false;\r\n  \r\n  // 检查基本结构\r\n  if (typeof content !== 'object') return false;\r\n  if (!content.topic || typeof content.topic !== 'string') return false;\r\n  if (!Array.isArray(content.pages)) return false;\r\n  \r\n  // 检查每个页面的结构\r\n  return content.pages.every((page: any) => {\r\n    if (!page.title || typeof page.title !== 'string') return false;\r\n    if (!Array.isArray(page.pages)) return false;\r\n    \r\n    // 检查子页面结构\r\n    return page.pages.every((subPage: any) => {\r\n      if (!subPage.sub_title || typeof subPage.sub_title !== 'string') return false;\r\n      if (!Array.isArray(subPage.desc)) return false;\r\n      if (!Array.isArray(subPage.contents)) return false;\r\n      return true;\r\n    });\r\n  });\r\n}\r\n","<template>\r\n  <div class=\"generate-ppt\" ref=\"pageContainer\">\r\n    <div class=\"ppt-header\">\r\n      <el-steps :active=\"activeStep\" finish-status=\"success\">\r\n        <el-step title=\"输入信息\" />\r\n        <el-step title=\"编辑课件内容\" />\r\n        <el-step title=\"选择模板\" />\r\n        <el-step title=\"生成课件\" />\r\n      </el-steps>\r\n    </div>\r\n\r\n    <!-- 保留key，但修改容器布局 -->\r\n    <div class=\"ppt-content\" :key=\"stepKey\">\r\n      <div class=\"step-content\">\r\n        <!-- 步骤1：输入信息 -->\r\n        <div v-if=\"activeStep === 0\" class=\"input-form\">\r\n          <div class=\"form-container\">\r\n            <el-form :model=\"inputForm\" label-width=\"120px\">\r\n              <!-- 年级选择 -->\r\n              <el-form-item label=\"年级\">\r\n                <el-select v-model=\"inputForm.grade\" placeholder=\"请选择年级\" @change=\"handleGradeChange\">\r\n                  <el-option\r\n                    v-for=\"item in gradeOptions\"\r\n                    :key=\"item.value\"\r\n                    :label=\"item.label\"\r\n                    :value=\"item.value\"\r\n                  />\r\n                </el-select>\r\n              </el-form-item>\r\n              \r\n              <!-- 学科选择 -->\r\n              <el-form-item label=\"学科\">\r\n                <el-select \r\n                  v-model=\"inputForm.subject\" \r\n                  placeholder=\"请选择学科\"\r\n                  :disabled=\"!inputForm.grade\"\r\n                >\r\n                  <el-option\r\n                    v-for=\"item in subjectOptions\"\r\n                    :key=\"item.value\"\r\n                    :label=\"item.label\"\r\n                    :value=\"item.value\"\r\n                  />\r\n                </el-select>\r\n              </el-form-item>\r\n              \r\n              <!-- 课时输入 -->\r\n              <el-form-item label=\"课时\">\r\n                <el-input v-model=\"inputForm.lesson\" placeholder=\"请输入课时名称\"/>\r\n              </el-form-item>\r\n              \r\n              <!-- 其他表单项保持不变 -->\r\n              <el-form-item label=\"复习要点\">\r\n                <el-input\r\n                  v-model=\"inputForm.reviewPoints\"\r\n                  type=\"textarea\"\r\n                  :rows=\"4\"\r\n                  placeholder=\"请输入本节课需要复习的主要知识点\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item label=\"普遍错题\">\r\n                <el-input\r\n                  v-model=\"inputForm.commonMistakes\"\r\n                  type=\"textarea\"\r\n                  :rows=\"4\"\r\n                  placeholder=\"根据作业情况，分析学生普遍没掌握的知识\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item label=\"下一节要点\">\r\n                <el-input\r\n                  v-model=\"inputForm.nextPoints\"\r\n                  type=\"textarea\"\r\n                  :rows=\"4\"\r\n                  placeholder=\"请输入下一节课的主要内容\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item class=\"form-actions\">\r\n                <el-button type=\"primary\" size=\"large\" @click=\"generateOutline\" :loading=\"generating\">\r\n                  <el-icon><MagicStick /></el-icon>\r\n                  <span>{{ generating ? '正在生成内容...' : '生成课件内容' }}</span>\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 步骤2：生成和编辑内容 -->\r\n        <div v-if=\"activeStep === 1\" class=\"outline-editor\">\r\n          <AIThinking\r\n            v-if=\"generating && !hasContent\"\r\n            :stages=\"thinkingStages\"\r\n            :keywords=\"thinkingKeywords\"\r\n            position-class=\"position-center\"\r\n            :show=\"true\"\r\n          />\r\n          \r\n          <!-- 修改这里：只在非编辑模式下显示生成的内容 -->\r\n          <div class=\"stream-content\" v-if=\"hasContent && !isEditing\">\r\n            <div class=\"formatted-content\" v-html=\"formattedText\"></div>\r\n          </div>\r\n          \r\n          <!-- 移到外面的操作按钮 -->\r\n          <div v-if=\"!generating && !isEditing\" class=\"action-buttons\">\r\n            <el-button type=\"\" @click=\"regenerateContent\">\r\n              <el-icon><Refresh /></el-icon>\r\n              重新生成提纲\r\n            </el-button>\r\n            <el-button type=\"primary\" @click=\"startEditing\">\r\n              <el-icon><Edit /></el-icon>\r\n              编辑课件内容\r\n            </el-button>\r\n          </div>\r\n          \r\n          <!-- 树状编辑器 -->\r\n          <div v-if=\"!generating && isEditing\" class=\"editor-layout\">\r\n            <div class=\"content-area\">\r\n              <el-tree\r\n                :data=\"treeData\"\r\n                :props=\"defaultProps\"\r\n                highlight-current\r\n                @node-click=\"handleNodeClick\"\r\n                :default-expand-all=\"true\"\r\n              >\r\n                <!-- 修改树节点内容的显示模板 -->\r\n                <template #default=\"{ node, data }\">\r\n                  <div class=\"tree-node-content\">\r\n                    <div class=\"node-header\">\r\n                      <el-icon><component :is=\"data.icon\" /></el-icon>\r\n                      <span class=\"page-label\">{{ data.orderLabel }}</span>\r\n                      <span class=\"node-title\">{{ node.label }}</span>\r\n                    </div>\r\n                    <!-- 修改内容显示逻辑 -->\r\n                    <div v-if=\"data.desc && data.contents\" class=\"node-content\">\r\n                      <div v-for=\"(desc, index) in data.desc\" :key=\"index\" class=\"content-pair\">\r\n                        <!-- 添加desc的编辑功能 -->\r\n                        <div class=\"content-desc\">\r\n                          <div v-if=\"editingContent.pageIndex === data.pageIndex && \r\n                                     editingContent.subPageIndex === data.subPageIndex && \r\n                                     editingContent.contentIndex === index &&\r\n                                     editingContent.type === 'desc'\" \r\n                               class=\"edit-mode\">\r\n                            <el-input\r\n                              v-model=\"editingContent.value\"\r\n                              type=\"textarea\"\r\n                              :rows=\"2\"\r\n                              @blur=\"saveContentEdit(data)\"\r\n                              @keyup.enter=\"saveContentEdit(data)\"\r\n                              v-focus\r\n                            />\r\n                          </div>\r\n                          <div v-else \r\n                               class=\"desc-text\"\r\n                               @click=\"startEdit(data, index, desc, 'desc')\">\r\n                            {{ desc }}\r\n                          </div>\r\n                        </div>\r\n                        <!-- 内容编辑部分 -->\r\n                        <div class=\"content-detail\" v-if=\"data.contents[index]\">\r\n                          <div v-if=\"editingContent.pageIndex === data.pageIndex && \r\n                                     editingContent.subPageIndex === data.subPageIndex && \r\n                                     editingContent.contentIndex === index &&\r\n                                     editingContent.type === 'content'\" \r\n                               class=\"edit-mode\">\r\n                            <el-input\r\n                              v-model=\"editingContent.value\"\r\n                              type=\"textarea\"\r\n                              :rows=\"2\"\r\n                              @blur=\"saveContentEdit(data)\"\r\n                              @keyup.enter=\"saveContentEdit(data)\"\r\n                              v-focus\r\n                            />\r\n                          </div>\r\n                          <div v-else \r\n                               class=\"content-text\"\r\n                               @click=\"startEdit(data, index, data.contents[index], 'content')\">\r\n                            {{ data.contents[index] }}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <!-- 普通内容显示 -->\r\n                    <div v-else-if=\"data.content\" class=\"node-content\">\r\n                      <template v-if=\"data.type === 'cover'\">\r\n                        <div v-if=\"editingContent.type === 'topic'\" class=\"edit-mode\">\r\n                          <el-input\r\n                            v-model=\"editingContent.value\"\r\n                            type=\"textarea\"\r\n                            :rows=\"2\"\r\n                            @blur=\"saveContentEdit(data)\"\r\n                            @keyup.enter=\"saveContentEdit(data)\"\r\n                            v-focus\r\n                          />\r\n                        </div>\r\n                        <div v-else class=\"content-text\" @click=\"startEdit(data, null, data.content, 'topic')\">\r\n                          课件主题：{{ data.content }}\r\n                        </div>\r\n                      </template>\r\n                      <template v-else-if=\"Array.isArray(data.content)\">\r\n                        <div v-for=\"(item, index) in data.content\" :key=\"index\" class=\"content-item\">\r\n                          {{ item }}\r\n                        </div>\r\n                      </template>\r\n                      <template v-else>\r\n                        {{ data.content }}\r\n                      </template>\r\n                    </div>\r\n                  </div>\r\n                </template>\r\n              </el-tree>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- 步骤操作按钮 -->\r\n          <div v-if=\"isEditing\" class=\"step-actions\">\r\n            <el-button type=\"primary\" size=\"large\" @click=\"nextStep\">\r\n              <el-icon><Right /></el-icon>\r\n              选择模板\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 步骤3：选择模板 -->\r\n        <div v-if=\"activeStep === 2\" class=\"templates\">\r\n          <!-- 模板选择操作按钮移到上方 -->\r\n          <div class=\"template-actions\">\r\n            <el-button \r\n              type=\"primary\" \r\n              size=\"large\" \r\n              @click=\"generatePPT\" \r\n              :disabled=\"isGenerating\">\r\n              <el-icon><DocumentAdd /></el-icon>\r\n              <span>生成复习课件</span>\r\n            </el-button>\r\n          </div>\r\n          \r\n          <!-- 模板选择区域 -->\r\n          <div class=\"templates-container\">\r\n            <el-radio-group v-model=\"selectedTemplate\">\r\n              <div class=\"templates-grid\">\r\n                <div v-for=\"template in templates\" :key=\"template.id\" class=\"template-item\">\r\n                  <el-radio :label=\"template.id\">\r\n                    <div class=\"template-card\">\r\n                      <div class=\"template-img-container\">\r\n                        <img :src=\"template.preview\" :alt=\"template.name\">\r\n                      </div>\r\n                      <span>{{ template.name }}</span>\r\n                    </div>\r\n                  </el-radio>\r\n                </div>\r\n              </div>\r\n            </el-radio-group>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 步骤4：完成 -->\r\n        <div v-if=\"activeStep === 3\">\r\n          <el-result\r\n            icon=\"success\"\r\n            title=\"PPT生成任务已开始\"\r\n            sub-title=\"系统正在为您生成PPT，您可以返回列表页查看进度\"\r\n          >\r\n            <template #extra>\r\n              <el-button type=\"primary\" size=\"large\" @click=\"backToList\">\r\n                <el-icon><Back /></el-icon>\r\n                <span>返回列表</span>\r\n              </el-button>\r\n            </template>\r\n          </el-result>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport AIThinking from '@/components/AIThinking.vue'\r\nimport { ref, computed, nextTick, onMounted, watch } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport axios from '@/utils/axios'\r\nimport { ElMessage, ElLoading } from 'element-plus'\r\nimport subjectConfig from '@/config/subject-config.json'\r\nimport { MagicStick, Right, DocumentAdd, Back, Document, Flag, Reading, Files, Plus, Delete, Menu, Loading, Refresh, Edit } from '@element-plus/icons-vue'\r\nimport config from '@/config/config'\r\nimport { cleanAndValidateJSON, validatePPTContent } from '@/utils/jsonValidator'\r\n\r\nconst router = useRouter()\r\nconst activeStep = ref(0)\r\nconst activeCollapse = ref(['cover'])\r\nconst currentEditType = ref('page')\r\nconst currentPageIndex = ref(0)\r\nconst currentSubPageIndex = ref(0)\r\nconst pptContent = ref({\r\n  topic: '',\r\n  pages: []\r\n})\r\nconst outlineText = ref('')\r\nconst templates = ref([])\r\nconst selectedTemplate = ref('')\r\nconst inputForm = ref({\r\n  grade: '',\r\n  subject: '',\r\n  lesson: '',\r\n  reviewPoints: '',\r\n  commonMistakes: '',\r\n  nextPoints: ''\r\n})\r\n\r\n// 年级选项\r\nconst gradeOptions = ref(subjectConfig.grades)\r\n\r\n// 学科选项，根据年级动态变化\r\nconst subjectOptions = computed(() => {\r\n  if (!inputForm.value.grade) return []\r\n  // 根据年级判断是小学还是初中\r\n  return inputForm.value.grade.includes('小学') \r\n    ? subjectConfig.subjects.primary \r\n    : subjectConfig.subjects.junior\r\n})\r\n\r\n// 在年级变化时重置学科选择\r\nfunction handleGradeChange() {\r\n  inputForm.value.subject = ''\r\n}\r\n\r\n// 生成完整的topic\r\nconst getTopic = () => {\r\n  const { grade, subject, lesson } = inputForm.value\r\n  if (!grade || !subject || !lesson) {\r\n    throw new Error('请完整填写年级、学科和课时信息')\r\n  }\r\n  return `${grade}${subject}${lesson}`\r\n}\r\n\r\nconst generating = ref(false)\r\nconst isStreaming = ref(false)\r\nconst streamContent = ref('')\r\nconst tempContent = ref('')\r\nconst currentBuffer = ref('')\r\n\r\nconst processedLength = ref(0)\r\n\r\n// 用于累积完整JSON的状态变量\r\nconst jsonBuffer = ref('')\r\nconst rawJsonContent = ref('')\r\nconst streamText = ref('')\r\n\r\nconst streamRef = ref(null)\r\n\r\n// 修改格式化文本的计算属性\r\nconst formattedText = computed(() => {\r\n  if (!streamText.value) return ''\r\n  \r\n  let result = ''\r\n  let currentTitle = ''\r\n  let currentDescList = []\r\n  let currentContentsList = []\r\n  \r\n  // 处理当前集合的desc和contents配对\r\n  const processCurrentPairs = () => {\r\n    // 如果有标题，先添加标题\r\n    if (currentTitle) {\r\n      result += `<div class=\"content-title\">${currentTitle}</div>`\r\n      currentTitle = ''\r\n    }\r\n    \r\n    // 按索引配对显示desc和contents\r\n    const maxLength = Math.min(currentDescList.length, currentContentsList.length)\r\n    for (let i = 0; i < maxLength; i++) {\r\n      result += `\r\n        <div class=\"content-pair\">\r\n          <div class=\"content-desc\">${currentDescList[i]}</div>\r\n          <div class=\"content-text\">${currentContentsList[i]}</div>\r\n        </div>`\r\n    }\r\n    \r\n    // 清空当前集合\r\n    currentDescList = []\r\n    currentContentsList = []\r\n  }\r\n\r\n  const lines = streamText.value\r\n    .replace(/[\\{\\}\\[\\]\"\\\\]/g, '')\r\n    .replace(/topic:|title:|pages:|sub_title:|desc:|contents:|,/g, '')\r\n    .replace(/\\n\\s+/g, '\\n')\r\n    .split('\\n')\r\n\r\n  for (const line of lines) {\r\n    const trimmed = line.trim()\r\n    if (!trimmed) continue\r\n    \r\n    // 处理主题\r\n    if (trimmed.includes('小学') || trimmed.includes('初中')) {\r\n      result += `<div class=\"content-topic\">${trimmed}</div>`\r\n      continue\r\n    }\r\n    \r\n    // 处理章节标题\r\n    if (trimmed.match(/^[一二三]、/)) {\r\n      processCurrentPairs() // 处理之前未配对的内容\r\n      currentTitle = trimmed\r\n      continue\r\n    }\r\n    \r\n    // 处理子标题\r\n    if (trimmed.includes('核心知识点') || \r\n        trimmed.includes('学习技巧') ||  \r\n        trimmed.includes('典型例子') ||\r\n        trimmed.includes('普遍错误') ||\r\n        trimmed.includes('错题解析') ||\r\n        trimmed.includes('下一节准备')) {\r\n      processCurrentPairs() // 处理之前未配对的内容\r\n      result += `<div class=\"content-subtitle\">${trimmed}</div>`\r\n      continue\r\n    }\r\n    \r\n    // 收集desc内容\r\n    if (trimmed.includes('知识点') || \r\n        trimmed.includes('技巧要点') ||  \r\n        trimmed.includes('例子场景') ||\r\n        trimmed.includes('错误类型') ||\r\n        trimmed.includes('解析要点') ||\r\n        trimmed.includes('学习目标') ||\r\n        trimmed.includes('预习重点')) {\r\n      currentDescList.push(trimmed)\r\n      continue\r\n    }\r\n    \r\n    // 收集普通内容\r\n    if (trimmed && !trimmed.includes('\"') && !trimmed.includes(':')) {\r\n      currentContentsList.push(trimmed)\r\n      continue\r\n    }\r\n  }\r\n  \r\n  // 处理最后可能剩余的配对\r\n  processCurrentPairs()\r\n  \r\n  return result\r\n})\r\n\r\n// 用一个更简单的方式处理滚动重置，只在步骤变化时调用\r\nwatch(() => activeStep.value, () => {\r\n  nextTick(() => {\r\n    window.scrollTo(0, 0)\r\n  })\r\n}, { immediate: true })\r\n\r\n// 添加内容状态判断\r\nconst hasContent = computed(() => streamText.value.length > 0)\r\n\r\n// 修改 generateOutline 函数中的处理逻辑\r\nasync function generateOutline() {\r\n  try {\r\n    if (!inputForm.value.grade || \r\n        !inputForm.value.subject || \r\n        !inputForm.value.lesson || \r\n        !inputForm.value.reviewPoints || \r\n        !inputForm.value.commonMistakes || \r\n        !inputForm.value.nextPoints) {\r\n      ElMessage.warning('请填写所有必要信息')\r\n      return\r\n    }\r\n    \r\n    generating.value = true\r\n    isEditing.value = false\r\n    streamText.value = ''\r\n    rawJsonContent.value = ''\r\n    \r\n    // 改变步骤\r\n    activeStep.value = 1\r\n    scrollToTop() // 添加滚动控制\r\n    \r\n    // 初始化空的PPT内容结构\r\n    pptContent.value = {\r\n      topic: getTopic(),\r\n      pages: []\r\n    }\r\n    \r\n    const topic = getTopic()\r\n    const response = await fetch(`${import.meta.env.VITE_API_BASE_URL}/api/ppt/outline`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        topic,\r\n        reviewPoints: inputForm.value.reviewPoints,\r\n        commonMistakes: inputForm.value.commonMistakes,\r\n        nextPoints: inputForm.value.nextPoints,\r\n        grade: inputForm.value.grade,\r\n        subject: inputForm.value.subject\r\n      })\r\n    })\r\n\r\n    const reader = response.body.getReader()\r\n    const decoder = new TextDecoder()\r\n\r\n    while (true) {\r\n      const { done, value } = await reader.read()\r\n      if (done) break\r\n\r\n      const chunk = decoder.decode(value)\r\n      const lines = chunk.split('\\n')\r\n      \r\n      for (const line of lines) {\r\n        if (!line.trim() || line.trim() === 'data: [DONE]') continue\r\n        \r\n        try {\r\n          const cleanLine = line.replace(/^data: /, '')\r\n          const json = JSON.parse(cleanLine)\r\n          if (json.choices?.[0]?.delta?.content) {\r\n            const content = json.choices[0].delta.content\r\n            streamText.value += content\r\n            rawJsonContent.value += content\r\n          }\r\n        } catch (e) {\r\n          console.warn('解析流数据失败:', e)\r\n        }\r\n      }\r\n    }\r\n\r\n    // 最终更新：增加JSON清理和验证步骤\r\n    try {\r\n      const cleanedJSON = cleanAndValidateJSON(rawJsonContent.value)\r\n      const finalContent = JSON.parse(cleanedJSON)\r\n      \r\n      // 验证内容结构\r\n      if (!validatePPTContent(finalContent)) {\r\n        throw new Error('PPT内容结构不符合要求')\r\n      }\r\n      \r\n      pptContent.value = finalContent\r\n      ElMessage.success('提纲生成成功')\r\n    } catch (e) {\r\n      console.error('内容解析或验证失败:', e)\r\n      ElMessage.error('内容解析失败：' + e.message)\r\n      // 重置状态\r\n      pptContent.value = {\r\n        topic: getTopic(),\r\n        pages: []\r\n      }\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('生成失败:', error)\r\n    ElMessage.error('生成提纲失败')\r\n  } finally {\r\n    generating.value = false\r\n  }\r\n}\r\n\r\nconst addObjective = () => {\r\n  pptContent.value.objectives.push('')\r\n}\r\n\r\nconst removeObjective = (index) => {\r\n  pptContent.value.objectives.splice(index, 1)\r\n}\r\n\r\nconst addSection = () => {\r\n  pptContent.value.sections.push({\r\n    title: '',\r\n    points: ['']\r\n  })\r\n}\r\n\r\nconst removeSection = (sIndex) => {\r\n  pptContent.value.sections.splice(sIndex, 1)\r\n}\r\n\r\nconst addPoint = (sIndex) => {\r\n  pptContent.value.sections[sIndex].points.push('')\r\n}\r\n\r\nconst removePoint = (sIndex, pIndex) => {\r\n  pptContent.value.sections[sIndex].points.splice(pIndex, 1)\r\n}\r\n\r\nasync function nextStep() {\r\n  if (!pptContent.value.topic || !pptContent.value.pages.length) {\r\n    ElMessage.warning('课件内容不能为空')\r\n    return\r\n  }\r\n  try {\r\n    const response = await axios.post(`${import.meta.env.VITE_API_BASE_URL}/api/ppt/templates`)\r\n    templates.value = response.data.templates\r\n    activeStep.value = 2\r\n    scrollToTop() // 添加滚动控制\r\n  } catch (error) {\r\n    ElMessage.error('获取模板失败')\r\n  }\r\n}\r\n\r\n// 添加生成状态标志\r\nconst isGenerating = ref(false);\r\n\r\nfunction generatePPT() {\r\n  if (!selectedTemplate.value) {\r\n    ElMessage.warning('请选择模板')\r\n    return\r\n  }\r\n  \r\n  // 设置生成状态为true，防止重复点击\r\n  isGenerating.value = true;\r\n  \r\n  // 准备请求数据\r\n  const topic = pptContent.value.topic\r\n  const requestData = {\r\n    topic: topic,\r\n    content: JSON.stringify(pptContent.value),\r\n    template_id: selectedTemplate.value\r\n  }\r\n  \r\n  // 发送请求，但不等待完成就跳转\r\n  axios.post(`${import.meta.env.VITE_API_BASE_URL}/api/ppt/generate`, requestData)\r\n    .then(async response => {\r\n      // 将新生成的PPT ID存储到localStorage，供列表页面轮询使用\r\n      localStorage.setItem('lastGeneratedPPT', JSON.stringify({\r\n        file_id: response.data.file_id,\r\n        time: Date.now()\r\n      }))\r\n      \r\n      console.log('PPT生成请求已发送，ID:', response.data.file_id)\r\n      \r\n      // 请求发送后立即跳转到步骤4\r\n      activeStep.value = 3  // 设置步骤为完成状态\r\n      \r\n      // 强制DOM更新并滚动到顶部\r\n      await nextTick();\r\n      window.scrollTo(0, 0);\r\n      \r\n      ElMessage.success('PPT生成任务已开始')\r\n    })\r\n    .catch(error => {\r\n      console.error('PPT生成请求失败', error)\r\n      ElMessage.error(error.response?.data?.detail || '生成PPT失败')\r\n    })\r\n    .finally(() => {\r\n      // 恢复按钮状态\r\n      isGenerating.value = false\r\n    })\r\n}\r\n\r\nfunction backToList() {\r\n  router.push('/aiedu/generate-ppt')\r\n}\r\n\r\n// 树状结构数据\r\nconst treeData = computed(() => {\r\n  const data = []\r\n  \r\n  // 添加封面页（主题）\r\n  data.push({\r\n    label: '课件封面',\r\n    type: 'cover',\r\n    orderLabel: '第1页：',\r\n    icon: 'Document',\r\n    content: pptContent.value?.topic || '请填写课件主题'\r\n  })\r\n\r\n  // 添加目录页\r\n  data.push({\r\n    label: '目录',\r\n    type: 'page',\r\n    orderLabel: '第2页：',\r\n    icon: 'Menu',\r\n    content: '课件目录页（自动生成）'\r\n  })\r\n\r\n  // 遍历主要内容页面\r\n  let pageCount = 3 // 从第3页开始计数\r\n  pptContent.value.pages.forEach((page, pageIndex) => {\r\n    // 添加章节主页\r\n    const pageNode = {\r\n      label: page.title,\r\n      type: 'page',\r\n      pageIndex,\r\n      orderLabel: `第${pageCount}页：`,\r\n      icon: 'Reading',\r\n      children: []\r\n    }\r\n    pageCount++\r\n\r\n    // 添加子页面\r\n    page.pages.forEach((subPage, subPageIndex) => {\r\n      pageNode.children.push({\r\n        label: subPage.sub_title,\r\n        type: 'subPage',\r\n        pageIndex,\r\n        subPageIndex,\r\n        orderLabel: `第${pageCount}页：`,\r\n        icon: 'Document',\r\n        desc: subPage.desc,\r\n        contents: subPage.contents\r\n      })\r\n      pageCount++\r\n    })\r\n    \r\n    data.push(pageNode)\r\n  })\r\n  \r\n  return data\r\n})\r\n\r\n// 处理节点点击事件\r\nconst handleNodeClick = (data) => {\r\n  currentEditType.value = data.type\r\n  if (data.type === 'page') {\r\n    currentPageIndex.value = data.pageIndex\r\n  } else if (data.type === 'subPage') {\r\n    currentPageIndex.value = data.pageIndex\r\n    currentSubPageIndex.value = data.subPageIndex\r\n  }\r\n}\r\n\r\n// 修改右侧编辑区域的内容渲染\r\nconst currentEditContent = computed(() => {\r\n  if (currentEditType.value === 'page' && pptContent.value.pages[currentPageIndex.value]) {\r\n    return {\r\n      title: pptContent.value.pages[currentPageIndex.value].title,\r\n      type: 'page'\r\n    }\r\n  } else if (currentEditType.value === 'subPage' && \r\n             pptContent.value.pages[currentPageIndex.value]?.pages[currentSubPageIndex.value]) {\r\n    const subPage = pptContent.value.pages[currentPageIndex.value].pages[currentSubPageIndex.value]\r\n    return {\r\n      title: subPage.sub_title,\r\n      desc: subPage.desc,\r\n      contents: subPage.contents,\r\n      type: 'subPage'\r\n    }\r\n  }\r\n  return null\r\n})\r\n\r\n// 添加编辑状态管理\r\nconst editingContent = ref({\r\n  pageIndex: null,\r\n  subPageIndex: null,\r\n  contentIndex: null,\r\n  value: '',\r\n  type: '' // 'topic', 'desc', 'content'\r\n})\r\n\r\n// 自定义指令：自动聚焦\r\nconst vFocus = {\r\n  mounted: (el) => el.querySelector('textarea').focus()\r\n}\r\n\r\n// 开始编辑\r\nconst startEdit = (data, index, content, type = 'content') => {\r\n  editingContent.value = {\r\n    pageIndex: data.pageIndex,\r\n    subPageIndex: data.subPageIndex,\r\n    contentIndex: index,\r\n    value: content,\r\n    type: type\r\n  }\r\n}\r\n\r\n// 保存编辑\r\nconst saveContentEdit = (data) => {\r\n  if (editingContent.value.type === 'topic') {\r\n    // 直接保存编辑的值作为 topic，不需要处理前缀\r\n    pptContent.value.topic = editingContent.value.value\r\n  } else if (data.pageIndex !== undefined && data.subPageIndex !== undefined) {\r\n    // 获取当前正在编辑的页面\r\n    const page = pptContent.value.pages[data.pageIndex]\r\n    if (page && page.pages[data.subPageIndex]) {\r\n      const subPage = page.pages[data.subPageIndex]\r\n      if (editingContent.value.type === 'desc') {\r\n        // 更新描述\r\n        subPage.desc[editingContent.value.contentIndex] = editingContent.value.value\r\n      } else {\r\n        // 更新内容\r\n        subPage.contents[editingContent.value.contentIndex] = editingContent.value.value\r\n      }\r\n    }\r\n  }\r\n  \r\n  // 重置编辑状态\r\n  editingContent.value = {\r\n    pageIndex: null,\r\n    subPageIndex: null,\r\n    contentIndex: null,\r\n    value: '',\r\n    type: ''\r\n  }\r\n}\r\n\r\n// 添加编辑模式标志\r\nconst isEditing = ref(false)\r\n\r\n// 编辑状态的key，用于强制重新渲染\r\nconst editingModeKey = computed(() => `editing-${isEditing.value ? 'true' : 'false'}`)\r\n\r\n// 重新生成内容\r\nconst regenerateContent = async () => {\r\n  isEditing.value = false\r\n  streamText.value = ''\r\n  rawJsonContent.value = ''\r\n  await generateOutline()\r\n}\r\n\r\n// 修改开始编辑函数，确保滚动到页面顶部\r\nconst startEditing = () => {\r\n  // 先设置状态\r\n  isEditing.value = true\r\n  \r\n  // 使用更强力的页面滚动方法组合\r\n  setTimeout(() => {\r\n    // 方法1: window.scrollTo - 最基础的页面滚动方法\r\n    window.scrollTo(0, 0);\r\n    \r\n    // 方法2: 设置document.documentElement和document.body的scrollTop\r\n    document.documentElement.scrollTop = 0;\r\n    document.body.scrollTop = 0;\r\n    \r\n    // 方法3: 使用scrollIntoView方法滚动到页面顶部元素\r\n    const headerElement = document.querySelector('.ppt-header');\r\n    if (headerElement) {\r\n      headerElement.scrollIntoView({ \r\n        behavior: 'auto',  // 使用auto确保立即滚动\r\n        block: 'start'     // 确保元素位于视口顶部\r\n      });\r\n    }\r\n    \r\n    console.log('已尝试滚动到页面顶部');\r\n  }, 150); // 增加延迟时间确保DOM完全更新\r\n}\r\n\r\n// 保留必要的计算属性\r\nconst stepKey = computed(() => `step-${activeStep.value}`)\r\n\r\n// 添加页面容器ref\r\nconst pageContainer = ref(null)\r\n\r\n// 修改后的滚动控制函数\r\nconst scrollToTop = () => {\r\n  nextTick(() => {\r\n    // 延迟执行滚动，确保DOM已更新\r\n    setTimeout(() => {\r\n      if (pageContainer.value) {\r\n        pageContainer.value.scrollIntoView({ \r\n          behavior: 'instant',\r\n          block: 'start'\r\n        })\r\n        // 兜底方案，确保滚动生效\r\n        window.scrollTo({\r\n          top: 0,\r\n          behavior: 'instant'\r\n        })\r\n      }\r\n    }, 100)\r\n  })\r\n}\r\n\r\n// 修改步骤切换的watch\r\nwatch(() => activeStep.value, (newStep, oldStep) => {\r\n  if (newStep !== oldStep) {\r\n    scrollToTop()\r\n  }\r\n}, { immediate: true })\r\n\r\n// 添加思考阶段和关键词配置\r\nconst thinkingStages = [\r\n  '正在分析课程结构...',\r\n  '正在提取教学重点...',\r\n  '正在设计PPT框架...',\r\n  '正在优化课件内容...'\r\n]\r\n\r\nconst thinkingKeywords = [\r\n  '课程目标',\r\n  '知识框架',\r\n  '教学重点',\r\n  '学习难点',\r\n  '课件结构',\r\n  '内容优化'\r\n]\r\n</script>\r\n\r\n<style scoped>\r\n@import '@/styles/generate_ppt_style.css';\r\n\r\n.ppt-header {\r\n  padding: 20px 0;\r\n}\r\n\r\n.ppt-content {\r\n  width: 100%;\r\n}\r\n\r\n/* 确保每个步骤从顶部开始但不限制高度，避免滚动条 */\r\n.step-content > div {\r\n  width: 100%;\r\n}\r\n\r\n/* 如果有需要，添加适当的间距 */\r\n.input-form, .outline-editor, .templates {\r\n  margin-bottom: 30px;\r\n}\r\n\r\n/* 确保编辑器布局能够从页面顶部开始显示 */\r\n.editor-layout {\r\n  margin-top: 0;\r\n  padding-top: 0;\r\n}\r\n\r\n/* 调整滚动控制 */\r\n.ppt-header {\r\n  position: relative; /* 确保可以作为滚动目标 */\r\n  z-index: 10;\r\n}\r\n\r\n.generate-ppt {\r\n  overflow-x: hidden;\r\n  overflow-y: auto;\r\n  height: auto;\r\n  position: relative;\r\n}\r\n\r\nbody {\r\n  scroll-behavior: auto !important; /* 确保页面滚动是即时的，不使用平滑滚动 */\r\n}\r\n\r\n/* 确保编辑器布局从顶部开始但不影响滚动 */\r\n.editor-layout {\r\n  margin-top: 0;\r\n  padding-top: 0;\r\n  position: relative;\r\n}\r\n\r\n/* 调整模板选择页面的样式 */\r\n.templates {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: calc(100vh - 180px); /* 适应窗口高度，减去头部和其他元素的高度 */\r\n  min-height: 400px; /* 设置最小高度 */\r\n  max-height: 800px; /* 设置最大高度 */\r\n  overflow: hidden; /* 防止出现滚动条 */\r\n}\r\n\r\n.template-actions {\r\n  padding: 0 0 16px 0;\r\n  margin-bottom: 26px;\r\n  position: sticky;\r\n  top: 0;\r\n  background-color: #fff;\r\n  z-index: 10;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.templates-container {\r\n  flex: 1;\r\n  overflow: auto; /* 如果内容过多，只在内部容器滚动 */\r\n  padding: 0 16px; /* 添加左右内边距 */\r\n  margin:0 auto;\r\n}\r\n\r\n/* 4列田字格布局 */\r\n.templates-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(4, minmax(200px, 280px)); /* 限制每列的最小和最大宽度 */\r\n  gap: 24px;\r\n  padding: 0 0 20px 0;\r\n  width: 100%;\r\n  justify-content: center; /* 居中对齐 */\r\n}\r\n\r\n/* 模板项整体 */\r\n.template-item {\r\n  position: relative;\r\n  margin-bottom: 10px;\r\n  max-width: 280px; /* 限制最大宽度 */\r\n  width: 100%;\r\n}\r\n\r\n/* 重置Element Plus Radio样式以避免冲突 */\r\n.template-item :deep(.el-radio) {\r\n  height: auto;\r\n  margin: 0;\r\n  padding: 0;\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n.template-item :deep(.el-radio__input) {\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  z-index: 2;\r\n}\r\n\r\n.template-item :deep(.el-radio__label) {\r\n  padding: 0;\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n/* 模板卡片 */\r\n.template-card {\r\n  background: #fff;\r\n  border: 1px solid #e4e7ed;\r\n  border-radius: 4px;\r\n  padding: 10px; \r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n/* 图片容器 - 16:9比例 */\r\n.template-img-container {\r\n  width: 100%;\r\n  position: relative;\r\n  padding-top: 56.25%; /* 16:9比例 */\r\n  margin-bottom: 10px;\r\n  overflow: hidden;\r\n  background-color: #f5f7fa; /* 添加背景色 */\r\n  border-radius: 4px;\r\n}\r\n\r\n/* 图片 - 填满容器并裁剪 */\r\n.template-card img {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain; /* 改为contain以确保图片完整显示 */\r\n  padding: 8px; /* 添加内边距，让图片不贴边 */\r\n  box-sizing: border-box;\r\n}\r\n\r\n/* 模板名称 */\r\n.template-card span {\r\n  font-size: 14px;\r\n  color: #606266;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  max-width: 100%;\r\n  padding: 0 5px;\r\n  margin-top: 5px;\r\n}\r\n\r\n/* 响应式调整 - 小屏幕减少列数并调整大小 */\r\n@media screen and (max-width: 1400px) {\r\n  .templates-grid {\r\n    grid-template-columns: repeat(3, minmax(200px, 280px));\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 992px) {\r\n  .templates-grid {\r\n    grid-template-columns: repeat(2, minmax(200px, 280px));\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 576px) {\r\n  .templates-grid {\r\n    grid-template-columns: minmax(200px, 280px);\r\n  }\r\n}\r\n\r\n.outline-editor {\r\n  position: relative;\r\n  min-height: 300px;\r\n}\r\n</style>\r\n"],"names":["cleanAndValidateJSON","text","firstBrace","lastBrace","jsonCandidate","e","validatePPTContent","content","page","subPage","router","useRouter","activeStep","ref","currentEditType","currentPageIndex","currentSubPageIndex","pptContent","templates","selectedTemplate","inputForm","gradeOptions","subjectConfig","subjectOptions","computed","handleGradeChange","getTopic","grade","subject","lesson","generating","rawJsonContent","streamText","formattedText","result","currentTitle","currentDescList","currentContentsList","processCurrentPairs","maxLength","i","lines","line","trimmed","watch","nextTick","hasContent","generateOutline","ElMessage","isEditing","scrollToTop","topic","reader","decoder","done","value","cleanLine","json","cleanedJSON","finalContent","error","nextStep","response","axios","isGenerating","generatePPT","requestData","backToList","treeData","data","pageCount","pageIndex","pageNode","subPageIndex","handleNodeClick","editingContent","vFocus","el","startEdit","index","type","saveContentEdit","regenerateContent","startEditing","headerElement","stepKey","pageContainer","newStep","oldStep","thinkingStages","thinkingKeywords","_createElementBlock","_createElementVNode","_hoisted_1","_createVNode","_component_el_steps","_component_el_step","_hoisted_2","_openBlock","_hoisted_3","_hoisted_4","_component_el_form","_component_el_form_item","_component_el_select","_cache","$event","_Fragment","_renderList","item","_createBlock","_component_el_option","_component_el_input","_component_el_button","_component_el_icon","_unref","MagicStick","_hoisted_5","AIThinking","_hoisted_6","_hoisted_8","Refresh","Edit","_hoisted_9","_hoisted_10","_component_el_tree","defaultProps","_withCtx","node","_hoisted_11","_hoisted_12","_resolveDynamicComponent","_hoisted_13","_toDisplayString","_hoisted_14","_hoisted_15","desc","_hoisted_16","_hoisted_17","_withKeys","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_createTextVNode","_hoisted_25","Right","_hoisted_26","_hoisted_27","DocumentAdd","_hoisted_28","_component_el_radio_group","_hoisted_29","template","_component_el_radio","_hoisted_30","_hoisted_31","_hoisted_33","_component_el_result","Back"],"mappings":"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"}