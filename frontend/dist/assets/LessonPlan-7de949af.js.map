{"version":3,"file":"LessonPlan-7de949af.js","sources":["../../src/utils/lessonPlanExporter.js","../../src/views/lesson/LessonPlan.vue"],"sourcesContent":["import { Document, Paragraph, TextRun, Packer, WidthType, Table, TableRow, TableCell, BorderStyle } from 'docx';\r\n\r\n/**\r\n * 将HTML格式的教案导出为Word文档\r\n * @param {string} htmlContent - HTML内容\r\n * @param {string} title - 文档标题（不会添加到文档中）\r\n * @returns {Promise<Blob>} word文档的blob对象\r\n */\r\nexport async function exportLessonPlanToDocx(htmlContent, title = '教案') {\r\n  // 创建一个临时的容器来解析HTML\r\n  const tempDiv = document.createElement('div');\r\n  tempDiv.innerHTML = htmlContent;\r\n  \r\n  // 创建文档对象 - 注意没有添加标题到文档的headers部分\r\n  const doc = new Document({\r\n    styles: {\r\n      default: {\r\n        document: {\r\n          run: {\r\n            size: 24, \r\n            font: 'Microsoft YaHei'\r\n          },\r\n          paragraph: {\r\n            spacing: { \r\n              line: 440, // 22磅行距 (22 * 20 = 440)\r\n              before: 120, \r\n              after: 120 \r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    sections: [{\r\n      properties: {},\r\n      children: processHtmlContent(tempDiv)\r\n    }]\r\n  });\r\n\r\n  return await Packer.toBlob(doc);\r\n}\r\n\r\n/**\r\n * 处理HTML内容并转换为docx元素\r\n * @param {Element} container - 包含HTML内容的DOM元素\r\n * @returns {Array} docx元素数组\r\n */\r\nfunction processHtmlContent(container) {\r\n  // 如果容器为空，返回一个默认段落\r\n  if (!container) {\r\n    return [new Paragraph({ text: '内容无法解析' })];\r\n  }\r\n\r\n  const docElements = [];\r\n  \r\n  try {\r\n    // 查找表格元素\r\n    const table = container.querySelector('table');\r\n    if (table) {\r\n      // 如果找到表格，创建docx表格\r\n      const tableRows = [];\r\n      \r\n      // 处理所有表格行\r\n      const rows = table.querySelectorAll('tr');\r\n      for (let i = 0; i < rows.length; i++) {\r\n        const row = rows[i];\r\n        const cells = [];\r\n        \r\n        // 处理行中的所有单元格\r\n        const tableCells = row.querySelectorAll('th, td');\r\n        for (let j = 0; j < tableCells.length; j++) {\r\n          const cell = tableCells[j];\r\n          \r\n          // 获取rowspan和colspan\r\n          const rowSpan = parseInt(cell.getAttribute('rowspan')) || 1;\r\n          const colSpan = parseInt(cell.getAttribute('colspan')) || 1;\r\n          \r\n          // 处理单元格内容\r\n          const cellContent = [];\r\n          \r\n          // 首先处理带有<br>标签的内容\r\n          const brParts = cell.innerHTML.split(/<br\\s*\\/?>/i);\r\n          \r\n          brParts.forEach(part => {\r\n            // 创建临时容器处理每一部分\r\n            const partDiv = document.createElement('div');\r\n            partDiv.innerHTML = part;\r\n            \r\n            // 获取文本内容并处理回车换行\r\n            const textContent = partDiv.textContent;\r\n            if (textContent) {\r\n              // 处理文本中的换行符（\\n），将每行文本作为单独段落\r\n              const textLines = textContent.split('\\n');\r\n              textLines.forEach((line, index) => {\r\n                if (line.trim()) {\r\n                  cellContent.push(\r\n                    new Paragraph({\r\n                      children: [\r\n                        new TextRun({ \r\n                          text: line.trim(),\r\n                        })\r\n                      ],\r\n                      // 减小段落间距以消除额外的空行\r\n                      spacing: { before: 0, after: 0 }\r\n                    })\r\n                  );\r\n                }\r\n                \r\n                // 不再添加额外的空行段落\r\n                // if (index < textLines.length - 1 && line.trim()) {\r\n                //   cellContent.push(new Paragraph({ spacing: { before: 0, after: 0 } }));\r\n                // }\r\n              });\r\n            }\r\n          });\r\n          \r\n          // 确保单元格有内容\r\n          if (cellContent.length === 0) {\r\n            cellContent.push(new Paragraph({ text: '' }));\r\n          }\r\n          \r\n          cells.push(\r\n            new TableCell({\r\n              children: cellContent,\r\n              rowSpan: rowSpan,\r\n              columnSpan: colSpan,\r\n              borders: {\r\n                top: { style: BorderStyle.SINGLE, size: 1 },\r\n                bottom: { style: BorderStyle.SINGLE, size: 1 },\r\n                left: { style: BorderStyle.SINGLE, size: 1 },\r\n                right: { style: BorderStyle.SINGLE, size: 1 }\r\n              }\r\n            })\r\n          );\r\n        }\r\n        \r\n        if (cells.length > 0) {\r\n          tableRows.push(new TableRow({ children: cells }));\r\n        }\r\n      }\r\n      \r\n      if (tableRows.length > 0) {\r\n        docElements.push(\r\n          new Table({\r\n            rows: tableRows,\r\n            width: {\r\n              size: 100,\r\n              type: WidthType.PERCENTAGE,\r\n            }\r\n          })\r\n        );\r\n      }\r\n    } else {\r\n      // 如果没有表格，将所有文本内容处理为多个段落\r\n      const textLines = container.textContent.trim().split('\\n');\r\n      textLines.forEach(line => {\r\n        if (line.trim()) {\r\n          docElements.push(\r\n            new Paragraph({\r\n              text: line.trim()\r\n            })\r\n          );\r\n        }\r\n      });\r\n    }\r\n  } catch (error) {\r\n    console.error('处理HTML内容出错:', error);\r\n    return [new Paragraph({ text: `处理错误: ${error.message}` })];\r\n  }\r\n  \r\n  // 如果没有生成任何内容，添加一个空段落\r\n  if (docElements.length === 0) {\r\n    docElements.push(new Paragraph({ text: '无内容' }));\r\n  }\r\n  \r\n  return docElements;\r\n}\r\n","<template>\r\n  <div class=\"lesson-plan-container\">\r\n    <el-row :gutter=\"20\" class=\"full-height-row\">\r\n      <!-- 左侧设置区域 -->\r\n      <el-col :span=\"10\" class=\"full-height-col\">\r\n        <el-card class=\"settings-card\">\r\n          <template #header>\r\n            <div class=\"card-header\">\r\n              <h3>备课助手</h3>\r\n            </div>\r\n          </template>\r\n\r\n          <div class=\"form-container scrollable-area\">\r\n            <el-form :model=\"formData\" label-position=\"top\">\r\n              <el-form-item label=\"年级和科目\">\r\n                <el-cascader\r\n                  v-model=\"formData.scopeSelection\"\r\n                  :options=\"subjectOptions.options\"\r\n                  :props=\"{\r\n                    checkStrictly: false,\r\n                    leaf: (data, node) => node.level === 3\r\n                  }\"\r\n                  placeholder=\"请选择年级和科目\"\r\n                  style=\"width: 100%\"\r\n                />\r\n              </el-form-item>\r\n\r\n              <el-form-item label=\"课题\">\r\n                <el-input \r\n                  v-model=\"formData.topic\"\r\n                  placeholder=\"请输入本节课的课题\"\r\n                />\r\n              </el-form-item>\r\n\r\n              <el-form-item label=\"课时数\">\r\n                <el-input-number \r\n                  v-model=\"formData.lessonCount\"\r\n                  :min=\"1\"\r\n                  :max=\"10\"\r\n                  controls-position=\"right\"\r\n                  style=\"width: 180px\"\r\n                />\r\n              </el-form-item>\r\n\r\n              <el-form-item>\r\n                <template #label>\r\n                  <span>参考资料</span>\r\n                  <span class=\"optional-note\">*上传本节课的教材内容会更准确，如没有可不传</span>\r\n                </template>\r\n                <el-upload\r\n                  class=\"plan-upload-container\"\r\n                  :auto-upload=\"true\"\r\n                  :on-change=\"handleFileChange\"\r\n                  :on-remove=\"handleRemoveFile\"\r\n                  :before-upload=\"beforeUpload\"\r\n                  :on-success=\"handleUploadSuccess\"\r\n                  :on-error=\"handleUploadError\"\r\n                  :file-list=\"fileList\"\r\n                  :action=\"uploadAction\"\r\n                  :headers=\"uploadHeaders\"\r\n                  accept=\".txt,.docx,.doc,.pdf\"\r\n                  drag\r\n                >\r\n                  <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n                  <div class=\"el-upload__text\">\r\n                    将文件拖到此处或 <em>点击选择文件</em>\r\n                  </div>\r\n                  <template #tip>\r\n                    <div class=\"upload-tip\">\r\n                      支持 txt、docx、doc、pdf 格式，文件大小不超过10MB\r\n                    </div>\r\n                  </template>\r\n                </el-upload>\r\n                \r\n                <!-- 显示已上传的文件 -->\r\n                <div v-if=\"planFile?.uploaded\" class=\"uploaded-file\">\r\n                  <el-icon color=\"#67C23A\"><document-checked /></el-icon>\r\n                  <span class=\"file-name\">{{ planFile.name }}</span>\r\n                  <el-tag type=\"success\" size=\"small\">已上传</el-tag>\r\n                </div>\r\n              </el-form-item>\r\n\r\n              <el-form-item>\r\n                <el-button \r\n                  type=\"primary\" \r\n                  :loading=\"loading\"\r\n                  @click=\"generatePlan\"\r\n                  size=\"large\"\r\n                  :disabled=\"isGenerating\"\r\n                >\r\n                  生成教案\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <!-- 右侧结果区域 -->\r\n      <el-col :span=\"14\" class=\"full-height-col\">\r\n        <el-card class=\"result-card\">\r\n          <template #header>\r\n            <div class=\"card-header\">\r\n              <h3>教案内容</h3>\r\n              <div class=\"header-actions\" v-if=\"generatedContent\">\r\n                <el-button \r\n                  v-if=\"!isEditing\" \r\n                  type=\"primary\" \r\n                  size=\"small\" \r\n                  @click=\"startEditing\"\r\n                  :disabled=\"isGenerating\"\r\n                >\r\n                  编辑\r\n                </el-button>\r\n                <template v-else>\r\n                  <el-button type=\"success\" size=\"small\" @click=\"saveEdit\">保存</el-button>\r\n                  <el-button size=\"small\" @click=\"cancelEdit\">取消</el-button>\r\n                </template>\r\n                <el-button \r\n                  type=\"primary\" \r\n                  size=\"small\" \r\n                  @click=\"exportToWord\"\r\n                  :disabled=\"isGenerating\"\r\n                >\r\n                  导出文档\r\n                </el-button>\r\n              </div>\r\n            </div>\r\n          </template>\r\n\r\n          <div class=\"result-container scrollable-area\">\r\n            <AIThinking\r\n              v-if=\"loading && !streamContent\"\r\n              :stages=\"thinkingStages\"\r\n              :keywords=\"thinkingKeywords\"\r\n              position-class=\"position-right\"\r\n              :show=\"true\"\r\n            />\r\n            \r\n            <div v-else-if=\"!generatedContent\" class=\"empty-result\">\r\n              <el-empty description=\"暂无教案，请设置条件并点击生成\" />\r\n            </div>\r\n            <template v-else>\r\n              <div v-if=\"!isEditing\" class=\"lesson-content\" v-html=\"sanitizeHtml(generatedContent)\"></div>\r\n              <el-input\r\n                v-else\r\n                v-model=\"editingContent\"\r\n                type=\"textarea\"\r\n                :rows=\"20\"\r\n                resize=\"none\"\r\n                class=\"edit-textarea\"\r\n              />\r\n            </template>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport AIThinking from '@/components/AIThinking.vue'\r\nimport { ref, reactive, computed, onBeforeUnmount } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { UploadFilled, DocumentChecked } from '@element-plus/icons-vue'\r\nimport DOMPurify from 'dompurify'\r\nimport examSubjectsConfig from '../../config/exam-subjects.json'\r\nimport { exportLessonPlanToDocx } from '@/utils/lessonPlanExporter'\r\n\r\nconst subjectOptions = ref(examSubjectsConfig)\r\nconst loading = ref(false)\r\nconst generatedContent = ref('')\r\n\r\nconst formData = reactive({\r\n  scopeSelection: [],\r\n  topic: '',\r\n  planDetails: '',\r\n  lessonCount: 1\r\n})\r\n\r\n// 添加文件上传相关状态\r\nconst fileList = ref([])\r\nconst planFile = ref(null)\r\n\r\n// 上传相关配置\r\nconst uploadHeaders = computed(() => {\r\n  const token = localStorage.getItem('token')\r\n  return {\r\n    'Authorization': token ? `Bearer ${token}` : ''\r\n  }\r\n})\r\n\r\n// 添加上传地址计算属性\r\nconst uploadAction = computed(() => `${import.meta.env.VITE_API_BASE_URL}/api/lesson-plan/upload-plan`)\r\n\r\n// 处理文件选择\r\nconst handleFileChange = (file) => {\r\n  planFile.value = {\r\n    ...file,\r\n    uniqueFilename: '',  // 添加 uniqueFilename 字段\r\n    uploaded: false\r\n  }\r\n  fileList.value = [file]\r\n  localStorage.removeItem('lessonPlanFile')  // 清除之前的文件记录\r\n}\r\n\r\n// 上传前验证\r\nconst beforeUpload = (file) => {\r\n  const allowedTypes = ['.txt', '.docx', '.doc', '.pdf']\r\n  const extension = file.name.substring(file.name.lastIndexOf('.')).toLowerCase()\r\n  \r\n  if (!allowedTypes.includes(extension)) {\r\n    ElMessage.error('只能上传txt、docx、doc或pdf格式的文件')\r\n    return false\r\n  }\r\n  \r\n  const isLt10M = file.size / 1024 / 1024 < 10\r\n  if (!isLt10M) {\r\n    ElMessage.error('文件大小不能超过10MB')\r\n    return false \r\n  }\r\n  \r\n  return true\r\n}\r\n\r\n// 处理上传成功\r\nconst handleUploadSuccess = (response, uploadFile) => {\r\n  if (response.success) {\r\n    const fileInfo = {\r\n      uniqueFilename: response.filename,\r\n      name: uploadFile.name\r\n    }\r\n    // 保存到本地存储\r\n    localStorage.setItem('lessonPlanFile', JSON.stringify(fileInfo))\r\n    \r\n    planFile.value = {\r\n      ...uploadFile,\r\n      uploaded: true,\r\n      uniqueFilename: response.filename\r\n    }\r\n    formData.planDetails = response.content\r\n    ElMessage.success('参考资料上传成功')\r\n  } else {\r\n    handleUploadError(response.message || '上传失败')\r\n  }\r\n}\r\n\r\n// 处理上传失败\r\nconst handleUploadError = (error) => {\r\n  ElMessage.error(typeof error === 'string' ? error : '上传失败，请重试')\r\n  planFile.value = null\r\n  fileList.value = []\r\n}\r\n\r\n// 处理移除文件\r\nconst handleRemoveFile = async () => {\r\n  await cleanUploadedFiles()\r\n  planFile.value = null\r\n  formData.planDetails = ''\r\n  fileList.value = []\r\n}\r\n\r\n// 在组件卸载前清理文件\r\nonBeforeUnmount(() => {\r\n  cleanUploadedFiles()\r\n})\r\n\r\n// 添加清理函数\r\nconst cleanUploadedFiles = async () => {\r\n  const fileInfoStr = localStorage.getItem('lessonPlanFile')\r\n  if (!fileInfoStr) return\r\n  \r\n  try {\r\n    const fileInfo = JSON.parse(fileInfoStr)\r\n    if (fileInfo?.uniqueFilename) {\r\n      console.log('开始清理文件', fileInfo.uniqueFilename)\r\n      const token = localStorage.getItem('token')\r\n      await fetch(`${import.meta.env.VITE_API_BASE_URL}/api/lesson-plan/remove-file`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': token ? `Bearer ${token}` : '',\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ filename: fileInfo.uniqueFilename })\r\n      })\r\n      localStorage.removeItem('lessonPlanFile')\r\n      console.log('文件清理完成')\r\n    }\r\n  } catch (error) {\r\n    console.error('清理文件失败:', error)\r\n  }\r\n}\r\n\r\n// 用于过滤未闭合HTML标签的函数\r\nconst filterIncompleteHtml = (content) => {\r\n  // 匹配完整的HTML标签\r\n  const cleanContent = content.replace(/<(?![\\/]?(tr|td|table|strong|pre|br)[>\\ ])([^>])*>/g, '')\r\n  // 只保留闭合完整的标签对\r\n  const openTags = (cleanContent.match(/<tr|<td|<table|<strong|<pre/g) || []).length\r\n  const closeTags = (cleanContent.match(/<\\/tr|<\\/td|<\\/table|<\\/strong|<\\/pre/g) || []).length\r\n  if (openTags === closeTags) {\r\n    return cleanContent\r\n  }\r\n  // 如果标签未闭合完整，则不显示最后一个未闭合的标签内容\r\n  return content.substring(0, content.lastIndexOf('<'))\r\n}\r\n\r\nconst isGenerating = ref(false) // 添加生成状态变量\r\n\r\nconst generatePlan = async () => {\r\n  if (!formData.scopeSelection || formData.scopeSelection.length < 3) {\r\n    ElMessage.warning('请选择年级和科目')\r\n    return\r\n  }\r\n  if (!formData.topic.trim()) {\r\n    ElMessage.warning('请输入课题')\r\n    return\r\n  }\r\n\r\n  loading.value = true\r\n  isGenerating.value = true // 设置生成状态为true\r\n  let streamContent = ''\r\n  \r\n  try {\r\n    const response = await fetch(`${import.meta.env.VITE_API_BASE_URL}/api/lesson-plan/generate`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n      },\r\n      body: JSON.stringify(formData)\r\n    })\r\n\r\n    const reader = response.body.getReader()\r\n    const decoder = new TextDecoder()\r\n    \r\n    // 添加首次接收内容的标记\r\n    let firstChunkReceived = false\r\n\r\n    while (true) {\r\n      const { done, value } = await reader.read()\r\n      if (done) break\r\n\r\n      const chunk = decoder.decode(value, { stream: true })\r\n      const lines = chunk.split('\\n')\r\n\r\n      for (const line of lines) {\r\n        if (line.startsWith('data: ')) {\r\n          const data = line.slice(5).trim()\r\n          if (data === '[DONE]') continue\r\n          \r\n          try {\r\n            const parsed = JSON.parse(data)\r\n            const content = parsed.choices[0].delta.content || ''\r\n            // 当收到第一个有效内容时，仅关闭loading状态，但保持isGenerating为true\r\n            if (!firstChunkReceived && content) {\r\n              loading.value = false\r\n              firstChunkReceived = true\r\n            }\r\n            streamContent += content\r\n            generatedContent.value = filterIncompleteHtml(streamContent)\r\n          } catch (e) {\r\n            if (data !== '[DONE]') {\r\n              console.error('解析数据失败:', e)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // 最后确保显示完整内容\r\n    generatedContent.value = streamContent\r\n    ElMessage.success('教案生成成功')\r\n  } catch (error) {\r\n    console.error('生成教案失败:', error)\r\n    ElMessage.error('生成教案失败，请重试')\r\n  } finally {\r\n    loading.value = false\r\n    isGenerating.value = false // 生成完成后设置状态为false\r\n  }\r\n}\r\n\r\nconst sanitizeHtml = (content) => {\r\n  if (!content) return ''\r\n  return DOMPurify.sanitize(content)\r\n}\r\n\r\nconst exportToWord = async () => {\r\n  try {\r\n    console.log('开始导出Word...');\r\n    \r\n    // 确保内容不为空\r\n    if (!generatedContent.value || generatedContent.value.trim() === '') {\r\n      ElMessage.warning('没有可导出的内容');\r\n      return;\r\n    }\r\n    \r\n    \r\n    // 使用新的导出函数处理HTML内容\r\n    console.log('准备导出内容长度:', generatedContent.value.length);\r\n    const blob = await exportLessonPlanToDocx(generatedContent.value, formData.topic || '教案');\r\n    \r\n    // 创建下载链接\r\n    const url = window.URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `${formData.topic || '教案'}.docx`;\r\n    \r\n    // 触发下载\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    \r\n    // 清理资源\r\n    setTimeout(() => {\r\n      window.URL.revokeObjectURL(url);\r\n      document.body.removeChild(link);\r\n    }, 100);\r\n    \r\n    ElMessage.success('导出成功');\r\n  } catch (error) {\r\n    console.error('导出失败详细信息:', error);\r\n    ElMessage.error(`导出失败: ${error.message || '未知错误'}`);\r\n  }\r\n}\r\n\r\n// 添加编辑相关的状态\r\nconst isEditing = ref(false)\r\nconst editingContent = ref('')\r\nconst originalContent = ref('')\r\n\r\n// 编辑相关方法\r\nconst startEditing = () => {\r\n  originalContent.value = generatedContent.value\r\n  editingContent.value = generatedContent.value\r\n  isEditing.value = true\r\n}\r\n\r\nconst saveEdit = () => {\r\n  generatedContent.value = editingContent.value\r\n  isEditing.value = false\r\n  ElMessage.success('保存成功')\r\n}\r\n\r\nconst cancelEdit = () => {\r\n  generatedContent.value = originalContent.value\r\n  isEditing.value = false\r\n}\r\n\r\n// 添加思考阶段和关键词配置\r\nconst thinkingStages = [\r\n  '正在分析教学目标...',\r\n  '正在设计教学环节...',\r\n  '正在优化教学方案...',\r\n  '正在完善教学设计...'\r\n]\r\n\r\nconst thinkingKeywords = [\r\n  '教学目标',\r\n  '重难点',\r\n  '教学方法',\r\n  '课程结构',\r\n  '教学活动',\r\n  '板书设计'\r\n]\r\n</script>\r\n\r\n<style scoped>\r\n.lesson-plan-container {\r\n  height: 100%;\r\n  min-height: 600px;\r\n  max-height: 100vh;\r\n  box-sizing: border-box;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.full-height-row {\r\n  flex: 1;\r\n  min-height: 0;\r\n}\r\n\r\n.full-height-col {\r\n  height: 100%;\r\n}\r\n\r\n.settings-card, .result-card {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n}\r\n\r\n.settings-card :deep(.el-card__body),\r\n.result-card :deep(.el-card__body) {\r\n  flex: 1;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 20px;\r\n}\r\n\r\n.scrollable-area {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: 0 10px 0 1px;\r\n}\r\n\r\n/* 为卡片头部添加背景色和高度 */\r\n.settings-card :deep(.el-card__header),\r\n.result-card :deep(.el-card__header) {\r\n  background: var(--bg-gradient-light);\r\n  padding: 0 20px;\r\n  height: 70px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n/* 确保头部的文字和按钮颜色 */\r\n.card-header {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  color: #20A4F3;\r\n}\r\n\r\n.number-input-container {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.number-input-container .el-button {\r\n  padding: 8px 15px;\r\n}\r\n\r\n.empty-result {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n}\r\n\r\n.lesson-content {\r\n  padding: 20px;\r\n  font-size: 16px;\r\n  line-height: 1.8;\r\n  color: #2c3e50;\r\n}\r\n\r\n.lesson-content :deep(table) {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin: 16px 0;\r\n  border: 1px solid #dcdfe6;\r\n  background-color: #ffffff;\r\n}\r\n\r\n.lesson-content :deep(th),\r\n.lesson-content :deep(td) {\r\n  padding: 12px;\r\n  border: 1px solid #dcdfe6;\r\n  text-align: left;\r\n  vertical-align: top;\r\n}\r\n\r\n/* 修改第一列的样式，添加粗体 */\r\n.lesson-content :deep(td:first-child) {\r\n  white-space: nowrap;\r\n  width: 120px;\r\n  color: #303133;\r\n  font-weight: 600; \r\n}\r\n\r\n.lesson-content :deep(pre) {\r\n  margin: 0;\r\n  white-space: pre-wrap;\r\n  font-family: inherit;\r\n}\r\n\r\n.lesson-content :deep(strong) {\r\n  color: #303133;\r\n  font-weight: 600;\r\n}\r\n\r\n.edit-textarea {\r\n  height: 100%;\r\n  font-family: 'Courier New', Courier, monospace;\r\n}\r\n\r\n.edit-textarea :deep(.el-textarea__inner) {\r\n  height: 100%;\r\n  padding: 12px;\r\n  line-height: 1.8;\r\n  font-size: 14px;\r\n}\r\n\r\n/* 滚动条样式 */\r\n.scrollable-area::-webkit-scrollbar {\r\n  width: 6px;\r\n}\r\n\r\n.scrollable-area::-webkit-scrollbar-thumb {\r\n  background-color: #dcdfe6;\r\n  border-radius: 3px;\r\n}\r\n\r\n.scrollable-area::-webkit-scrollbar-track {\r\n  background-color: #f8f9fa;\r\n}\r\n\r\n/* 添加上传组件样式 */\r\n.plan-upload-container {\r\n  width: 100%;\r\n}\r\n\r\n.plan-upload-container :deep(.el-upload) {\r\n  width: 100%;\r\n}\r\n\r\n.plan-upload_container :deep(.el-upload-dragger) {\r\n  width: 100%;\r\n  height: 200px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 20px;\r\n}\r\n\r\n.el-icon--upload {\r\n  font-size: 48px;\r\n  color: #409eff;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.el-upload__text {\r\n  font-size: 16px;\r\n  color: #606266;\r\n  margin: 8px 0;\r\n}\r\n\r\n.el-upload__text em {\r\n  color: #409eff;\r\n  font-style: normal;\r\n  font-weight: bold;\r\n}\r\n\r\n.upload-tip {\r\n  font-size: 12px;\r\n  color: #909399;\r\n  margin-top: 8px;\r\n  text-align: center;\r\n}\r\n\r\n.uploaded-file {\r\n  margin-top: 16px;\r\n  padding: 12px;\r\n  border-radius: 4px;\r\n  background-color: #f0f9eb;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.uploaded-file .el-icon {\r\n  font-size: 20px;\r\n}\r\n\r\n.uploaded-file .file-name {\r\n  flex: 1;\r\n  color: #606266;\r\n  font-size: 14px;\r\n  margin: 0 8px;\r\n  word-break: break-all;\r\n}\r\n\r\n/* 添加备注样式 */\r\n.optional-note {\r\n  font-size: 13px;\r\n  color: #f56c6c;\r\n  margin-left: 4px;\r\n  font-weight: normal;\r\n}\r\n\r\n.el-card__header{\r\n  background:var(--bg-gradient-light);\r\n  color: #20A4F3 !important;\r\n}\r\n\r\n.result-container {\r\n  position: relative;\r\n  min-height: 300px;\r\n}\r\n\r\n.overlay-container {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  z-index: 10;\r\n  background: rgba(255, 255, 255, 0.9);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.overlay-container .message {\r\n  text-align: center;\r\n  color: #606266;\r\n  font-size: 18px;\r\n}\r\n\r\n.overlay-container .el-icon {\r\n  margin-bottom: 16px;\r\n  color: #409eff;\r\n  font-size: 48px;\r\n}\r\n</style>\r\n"],"names":["exportLessonPlanToDocx","htmlContent","title","tempDiv","doc","Document","processHtmlContent","Packer","container","Paragraph","docElements","table","tableRows","rows","i","row","cells","tableCells","j","cell","rowSpan","colSpan","cellContent","part","partDiv","textContent","line","index","TextRun","TableCell","BorderStyle","TableRow","Table","WidthType","error","subjectOptions","ref","examSubjectsConfig","loading","generatedContent","formData","reactive","fileList","planFile","uploadHeaders","computed","token","uploadAction","handleFileChange","file","beforeUpload","allowedTypes","extension","ElMessage","handleUploadSuccess","response","uploadFile","fileInfo","handleUploadError","handleRemoveFile","cleanUploadedFiles","onBeforeUnmount","fileInfoStr","filterIncompleteHtml","content","cleanContent","openTags","closeTags","isGenerating","generatePlan","streamContent","reader","decoder","firstChunkReceived","done","value","lines","data","e","sanitizeHtml","DOMPurify","exportToWord","blob","url","link","isEditing","editingContent","originalContent","startEditing","saveEdit","cancelEdit","thinkingStages","thinkingKeywords","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_component_el_row","_component_el_col","_component_el_card","_cache","_createElementVNode","_hoisted_2","_component_el_form","_component_el_form_item","_component_el_cascader","$event","node","_component_el_input","_component_el_input_number","_component_el_upload","_component_el_icon","_unref","UploadFilled","_hoisted_3","DocumentChecked","_hoisted_4","_toDisplayString","_component_el_tag","_component_el_button","_hoisted_5","_hoisted_6","_Fragment","_createBlock","_hoisted_7","AIThinking","_hoisted_8","_component_el_empty"],"mappings":"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"}