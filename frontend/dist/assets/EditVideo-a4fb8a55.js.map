{"version":3,"file":"EditVideo-a4fb8a55.js","sources":["../../src/views/ppt2video/EditVideo.vue"],"sourcesContent":["<template>\r\n  <div class=\"video-editor\" v-loading.fullscreen.lock=\"loading\" element-loading-text=\"正在加载视频数据...\">\r\n    <!-- 顶部导航 -->\r\n    <div class=\"editor-header\">\r\n      <el-page-header @back=\"goBack\" title=\"返回列表\" content=\"编辑视频\">\r\n        <template #extra>\r\n          <el-button type=\"primary\" :disabled=\"!currentSlide\" @click=\"handleSave\">\r\n            <el-icon><Check /></el-icon>\r\n            保存草稿\r\n          </el-button>\r\n        </template>\r\n      </el-page-header>\r\n    </div>\r\n\r\n    <!-- 主编辑区域 -->\r\n    <div class=\"editor-main\">\r\n      <!-- 左侧边栏：缩略图 -->\r\n      <div class=\"editor-sidebar-left\">\r\n        <!-- 缩略图列表 -->\r\n        <div v-if=\"previewImages.length > 0\" class=\"thumbnails-list\">\r\n          <el-scrollbar height=\"calc(100vh - 180px)\">\r\n            <div \r\n              v-for=\"(img, index) in formattedImages\" \r\n              :key=\"index\"\r\n              class=\"thumbnail-item\"\r\n              :class=\"{ active: currentSlideIndex === index }\"\r\n              @click=\"handleThumbnailClick(index)\"\r\n            >\r\n              <img :src=\"img\" :alt=\"'幻灯片 ' + (index + 1)\">\r\n              <div class=\"thumbnail-index\">第 {{ index + 1 }} 页</div>\r\n            </div>\r\n          </el-scrollbar>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 中间主内容区：大图预览和备注 -->\r\n      <div class=\"editor-content\">\r\n        <div class=\"preview-section\" v-if=\"currentSlide\">\r\n          <img :src=\"currentSlide\" alt=\"当前幻灯片\" class=\"preview-image\">\r\n        </div>\r\n        <div class=\"notes-section\">\r\n          <el-input\r\n            v-model=\"currentNotes\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            :resize=\"none\"\r\n            placeholder=\"在此输入当前页面的解说文字...\"\r\n            @blur=\"updateSlideNote\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 右侧工具栏 -->\r\n      <div class=\"editor-sidebar-right\">\r\n        <div class=\"tools-section\">\r\n          <el-button-group vertical>\r\n            <el-button \r\n              type=\"success\" \r\n              @click=\"handleGenerate\" \r\n              :loading=\"generatingVideo\"\r\n              :disabled=\"!previewImages.length || generatingVideo\"\r\n            >\r\n              <el-icon><VideoCamera /></el-icon>\r\n              重新生成视频\r\n            </el-button>\r\n            <el-button \r\n              type=\"info\" \r\n              @click=\"handlePreview\"\r\n              :disabled=\"!videoUrl\"\r\n            >\r\n              <el-icon><View /></el-icon>\r\n              预览视频\r\n            </el-button>\r\n          </el-button-group>\r\n        </div>\r\n        \r\n        <!-- 视频生成设置 -->\r\n        <div class=\"settings-section\" v-if=\"previewImages.length > 0\">\r\n          <h4>视频设置</h4>\r\n          <el-form label-position=\"top\" size=\"small\">\r\n            <el-form-item label=\"每页停留时间\">\r\n              <el-input-number \r\n                v-model=\"slideDuration\" \r\n                :min=\"1\" \r\n                :max=\"20\" \r\n                :step=\"1\"\r\n                size=\"small\"\r\n              />\r\n              <span class=\"unit\">秒</span>\r\n            </el-form-item>\r\n            \r\n            <!-- 替换原来的语音选择为自定义组件 -->\r\n            <el-form-item label=\"语音类型\">\r\n              <voice-selector v-model=\"voiceType\" />\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 视频预览对话框 -->\r\n    <el-dialog\r\n      v-model=\"videoPreviewVisible\"\r\n      title=\"视频预览\"\r\n      width=\"70%\"\r\n      custom-class=\"video-preview-dialog\"\r\n      destroy-on-close  \r\n      @closed=\"handleVideoDialogClose\"\r\n    >\r\n      <div class=\"video-container\" v-if=\"videoUrl\">\r\n        <video \r\n          controls \r\n          :src=\"`${API_BASE_URL}${videoUrl}`\" \r\n          style=\"width: 100%;\"\r\n          ref=\"videoPlayer\"\r\n          key=\"video-preview\" \r\n        ></video>\r\n      </div>\r\n      <div v-else class=\"no-video\">\r\n        <el-empty description=\"尚未生成视频\"></el-empty>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { \r\n  Check, \r\n  VideoCamera, \r\n  View\r\n} from '@element-plus/icons-vue'\r\nimport axios from '@/utils/axios'\r\n\r\n// 导入自定义语音选择器组件\r\nimport VoiceSelector from '@/components/VoiceSelector.vue'\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst videoId = parseInt(route.params.id)\r\n\r\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000'\r\n\r\n// 状态变量\r\nconst loading = ref(true)\r\nconst previewImages = ref([])\r\nconst currentSlideIndex = ref(-1)\r\nconst currentNotes = ref('')\r\nconst slideNotes = ref([])\r\nconst sessionId = ref('')\r\nconst generatingVideo = ref(false)\r\nconst videoUrl = ref('')\r\nconst videoPreviewVisible = ref(false)\r\nconst videoPlayer = ref(null)\r\n\r\n// 视频生成设置\r\nconst slideDuration = ref(3)\r\nconst voiceType = ref('aixia')\r\n\r\n// 处理图片URL\r\nconst formattedImages = computed(() => {\r\n  return previewImages.value.map(img => `${API_BASE_URL}${img}`)\r\n})\r\n\r\n// 当前选中的幻灯片\r\nconst currentSlide = computed(() => {\r\n  if (currentSlideIndex.value >= 0 && formattedImages.value.length > 0) {\r\n    return formattedImages.value[currentSlideIndex.value]\r\n  }\r\n  return null\r\n})\r\n\r\n// 页面加载时获取视频数据\r\nonMounted(async () => {\r\n  try {\r\n    await loadVideoData();\r\n    \r\n    // 删除设置自动保存的代码\r\n    // 不需要定时自动保存\r\n  } catch (error) {\r\n    ElMessage.error('加载视频数据失败');\r\n    console.error('加载视频数据失败:', error);\r\n  } finally {\r\n    // 确保无论成功还是失败都关闭loading状态\r\n    loading.value = false;\r\n  }\r\n});\r\n\r\n// 加载视频数据\r\nasync function loadVideoData() {\r\n  try {\r\n    const response = await axios.get(`${API_BASE_URL}/api/ppt2video/edit/${videoId}`)\r\n    const data = response.data\r\n    \r\n    console.log('加载到的视频数据:', data); // 添加日志便于调试\r\n    \r\n    previewImages.value = data.images || []\r\n    slideNotes.value = data.notes || []\r\n    sessionId.value = data.session_id\r\n    voiceType.value = data.voice_type || 'aixia'\r\n    slideDuration.value = data.duration || 3\r\n    \r\n    // 添加日志，验证解说文本是否正确加载\r\n    console.log(`加载了 ${previewImages.value.length} 张幻灯片和 ${slideNotes.value.length} 条解说文本`);\r\n    console.log('解说文本示例:', slideNotes.value.slice(0, 2));\r\n    \r\n    // 设置初始选择的幻灯片\r\n    if (previewImages.value.length > 0) {\r\n      currentSlideIndex.value = 0\r\n      // 确保当前笔记正确加载\r\n      currentNotes.value = slideNotes.value[0] || ''\r\n      console.log('选择第一张幻灯片，笔记内容:', currentNotes.value);\r\n    }\r\n    \r\n    // 更新视频URL，便于预览\r\n    try {\r\n      const videoResponse = await axios.get(`${API_BASE_URL}/api/video/${videoId}`);\r\n      if (videoResponse.data && videoResponse.data.videoUrl) {\r\n        videoUrl.value = videoResponse.data.videoUrl;\r\n      }\r\n    } catch (e) {\r\n      console.warn('获取视频URL失败:', e);\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('加载视频数据失败:', error);\r\n    ElMessage.error('加载视频数据失败');\r\n    throw error; // 抛出错误以便上层函数的catch和finally可以执行\r\n  }\r\n}\r\n\r\nfunction goBack() {\r\n  router.push('/aiedu/ppt-to-video')\r\n}\r\n\r\nfunction handleThumbnailClick(index) {\r\n  currentSlideIndex.value = index\r\n  currentNotes.value = slideNotes.value[index] || ''\r\n}\r\n\r\n// 保存视频数据 - 简化版本\r\nasync function saveVideoData() {\r\n  if (!sessionId.value || !slideNotes.value.length) {\r\n    console.log('没有数据可保存');\r\n    return false;\r\n  }\r\n  \r\n  try {\r\n    // 确保当前幻灯片的备注已保存\r\n    updateSlideNote();\r\n    \r\n    // 构建请求数据\r\n    const requestData = {\r\n      sessionId: sessionId.value,\r\n      notes: slideNotes.value,\r\n      duration: slideDuration.value,\r\n      voiceType: voiceType.value,\r\n      video_id: videoId\r\n    };\r\n    \r\n    console.log(`开始保存草稿，videoId=${videoId}`);\r\n    \r\n    // 发送请求\r\n    const response = await axios.post(\r\n      `${API_BASE_URL}/api/ppt2video/save-draft`, \r\n      requestData\r\n    );\r\n    \r\n    console.log('草稿保存结果:', response.data);\r\n    \r\n    if (response.data && response.data.status === 'success') {\r\n      return true;\r\n    } else {\r\n      console.error('保存失败:', response.data?.message || '未知错误');\r\n      return false;\r\n    }\r\n  } catch (error) {\r\n    console.error('保存草稿异常:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// 修改保存按钮的点击事件处理\r\nasync function handleSave() {\r\n  // 保存当前幻灯片的备注\r\n  updateSlideNote();\r\n  \r\n  // 保存到服务器\r\n  loading.value = true;\r\n  try {\r\n    const result = await saveVideoData();\r\n    if (result) {\r\n      ElMessage.success('草稿保存成功');\r\n    } else {\r\n      ElMessage.warning('保存失败，请稍后再试');\r\n    }\r\n  } catch (error) {\r\n    console.error('保存草稿处理错误:', error);\r\n    ElMessage.error('保存失败: ' + (error.message || '未知错误'));\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nasync function handleGenerate() {\r\n  try {\r\n    // 先保存草稿\r\n    await saveVideoData();\r\n    \r\n    // 显示确认对话框\r\n    await ElMessageBox.confirm(\r\n      '确定要重新生成视频吗？这将覆盖原有视频。',\r\n      '重新生成视频',\r\n      {\r\n        confirmButtonText: '确认生成',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }\r\n    )\r\n    \r\n    // 设置生成状态为true\r\n    generatingVideo.value = true\r\n    \r\n    // 打印详细的请求参数，用于调试\r\n    console.log('提交视频生成请求:', {\r\n      sessionId: sessionId.value,\r\n      notes: slideNotes.value,\r\n      duration: slideDuration.value,\r\n      voiceType: voiceType.value,\r\n      video_id: videoId\r\n    });\r\n    \r\n    // 检查和验证参数\r\n    if (!sessionId.value) {\r\n      throw new Error('会话ID不能为空');\r\n    }\r\n    \r\n    if (!slideNotes.value || slideNotes.value.length === 0) {\r\n      console.warn('警告: 解说文本为空或长度为0');\r\n    }\r\n    \r\n    // 调用后端API生成视频\r\n    const response = await axios.post(`${API_BASE_URL}/api/ppt2video/generate-video`, {\r\n      sessionId: sessionId.value,\r\n      notes: slideNotes.value,\r\n      duration: slideDuration.value,\r\n      voiceType: voiceType.value,\r\n      video_id: videoId  // 传递视频ID表示这是编辑模式\r\n    })\r\n    \r\n    console.log('生成视频响应:', response.data);\r\n    \r\n    if (response.data.task_id) {\r\n      const taskId = response.data.task_id\r\n      ElMessage.success('视频生成任务已提交，正在后台处理中...')\r\n      \r\n      // 轮询任务状态\r\n      pollTaskStatus(taskId)\r\n    } else {\r\n      throw new Error('未获取到任务ID')\r\n    }\r\n  } catch (error) {\r\n    if (error === 'cancel') {\r\n      return\r\n    }\r\n    console.error('生成视频失败:', error)\r\n    ElMessage.error(error.response?.data?.detail || '生成视频失败，请重试')\r\n    generatingVideo.value = false\r\n  }\r\n}\r\n\r\n// 轮询任务状态的函数\r\nfunction pollTaskStatus(taskId, attempts = 0) {\r\n  setTimeout(async () => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/api/ppt2video/task/${taskId}`)\r\n      const status = response.data.status\r\n      \r\n      if (status === 'completed') {\r\n        generatingVideo.value = false\r\n        videoUrl.value = response.data.result.video_url\r\n        ElMessage.success('视频重新生成成功!')\r\n        \r\n        // 自动打开预览\r\n        videoPreviewVisible.value = true\r\n      } else if (status === 'failed') {\r\n        generatingVideo.value = false\r\n        ElMessage.error(`视频生成失败: ${response.data.error || '未知错误'}`)\r\n      } else if (status === 'running' || status === 'pending') {\r\n        if (attempts < 120) {\r\n          generatingVideo.value = true\r\n          pollTaskStatus(taskId, attempts + 1)\r\n        } else {\r\n          generatingVideo.value = false\r\n          ElMessage.info('视频生成仍在进行中，请稍后在\"我的视频\"列表中查看结果。')\r\n        }\r\n      } else {\r\n        generatingVideo.value = false\r\n        ElMessage.warning('无法获取视频生成状态，请在\"我的视频\"列表中查看结果。')\r\n      }\r\n    } catch (error) {\r\n      console.error('获取任务状态失败:', error)\r\n      if (attempts < 10) {\r\n        pollTaskStatus(taskId, attempts + 1)\r\n      } else {\r\n        generatingVideo.value = false\r\n        ElMessage.error('获取视频生成状态失败，请在\"我的视频\"列表中查看结果。')\r\n      }\r\n    }\r\n  }, 1000)\r\n}\r\n\r\nfunction handlePreview() {\r\n  if (videoUrl.value) {\r\n    // 添加时间戳避免缓存\r\n    videoUrl.value = `${videoUrl.value}?t=${new Date().getTime()}`\r\n    videoPreviewVisible.value = true\r\n  } else {\r\n    // 如果还没有重新生成视频，使用原视频URL\r\n    axios.get(`${API_BASE_URL}/api/video/${videoId}`)\r\n      .then(response => {\r\n        if (response.data && response.data.videoUrl) {\r\n          // 直接使用API返回的带时间戳的URL\r\n          videoUrl.value = response.data.videoUrl\r\n          videoPreviewVisible.value = true\r\n        } else {\r\n          ElMessage.info('无法获取视频URL')\r\n        }\r\n      })\r\n      .catch(() => {\r\n        ElMessage.error('无法获取视频信息')\r\n      })\r\n  }\r\n}\r\n\r\n// 更新当前幻灯片的备注\r\nfunction updateSlideNote() {\r\n  if (currentSlideIndex.value >= 0) {\r\n    if (currentNotes.value !== slideNotes.value[currentSlideIndex.value]) {\r\n      console.log(`更新第 ${currentSlideIndex.value + 1} 页解说文本:`, currentNotes.value);\r\n      slideNotes.value[currentSlideIndex.value] = currentNotes.value;\r\n    }\r\n  }\r\n}\r\n\r\n// 处理视频对话框关闭\r\nfunction handleVideoDialogClose() {\r\n  if (videoPlayer.value) {\r\n    videoPlayer.value.pause()\r\n    videoPlayer.value.currentTime = 0\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* 复用原CreateVideo.vue的样式 */\r\n/* 基础布局 */\r\n.video-editor {\r\n  height: calc(100vh - 60px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n  margin: -16px;\r\n}\r\n\r\n.editor-header {\r\n  padding: 12px 16px;\r\n  border-bottom: 1px solid var(--el-border-color-light);\r\n  flex-shrink: 0;\r\n}\r\n\r\n.editor-main {\r\n  flex: 1;\r\n  display: flex;\r\n  min-height: 0;\r\n  height: calc(100% - 52px);\r\n}\r\n\r\n/* 左侧边栏 */\r\n.editor-sidebar-left {\r\n  width: 180px;\r\n  border-right: 1px solid var(--el-border-color-light);\r\n  display: flex;\r\n  flex-direction: column;\r\n  border-right: 1px solid var(--el-border-color-light);\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex-shrink: 0;\r\n}\r\n\r\n/* 缩略图列表 */\r\n.thumbnails-list {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.thumbnail-item {\r\n  padding: 8px;\r\n  cursor: pointer;\r\n  border-bottom: 1px solid var(--el-border-color-light);\r\n}\r\n\r\n.thumbnail-item:hover {\r\n  background-color: var(--el-fill-color-light);\r\n}\r\n\r\n.thumbnail-item.active {\r\n  background-color: var(--el-color-primary-light-9);\r\n}\r\n\r\n.thumbnail-item img {\r\n  width: 100%;\r\n  border-radius: 4px;\r\n}\r\n\r\n.thumbnail-index {\r\n  text-align: center;\r\n  margin-top: 4px;\r\n  color: var(--el-text-color-secondary);\r\n  font-size: 12px;\r\n}\r\n\r\n/* 主内容区 */\r\n.editor-content {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 16px;\r\n  min-width: 0;\r\n}\r\n\r\n.preview-section {\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-bottom: 12px;\r\n  background-color: var(--el-fill-color);\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  height: calc(100% - 92px);\r\n}\r\n\r\n.preview-image {\r\n  max-width: 100%;\r\n  height: auto;\r\n  object-fit: contain;\r\n}\r\n\r\n.notes-section {\r\n  height: 80px;\r\n  margin-top: auto;\r\n}\r\n\r\n/* 右侧工具栏 */\r\n.editor-sidebar-right {\r\n  width: 160px;\r\n  border-left: 1px solid var(--el-border-color-light);\r\n  padding: 16px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.tools-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n}\r\n\r\n.settings-section {\r\n  margin-top: 20px;\r\n  padding-top: 20px;\r\n  border-top: 1px solid var(--el-border-color-light);\r\n}\r\n\r\n.settings-section h4 {\r\n  margin-bottom: 12px;\r\n  color: var(--el-text-color-primary);\r\n}\r\n\r\n.unit {\r\n  margin-left: 5px;\r\n  color: var(--el-text-color-secondary);\r\n  font-size: 12px;\r\n}\r\n\r\n/* Element Plus 组件样式覆盖 */\r\n:deep(.el-button-group) {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n}\r\n\r\n:deep(.el-button-group .el-button) {\r\n  width: 100%;\r\n  margin: 0;\r\n  border-radius: 4px;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n:deep(.el-textarea__inner) {\r\n  resize: none;\r\n}\r\n\r\n.video-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  background-color: #000;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n}\r\n\r\n.video-preview-dialog :deep(.el-dialog__body) {\r\n  padding-top: 10px;\r\n}\r\n\r\n.no-video {\r\n  height: 300px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n</style>\r\n"],"names":["router","useRouter","route","useRoute","videoId","API_BASE_URL","loading","ref","previewImages","currentSlideIndex","currentNotes","slideNotes","sessionId","generatingVideo","videoUrl","videoPreviewVisible","videoPlayer","slideDuration","voiceType","formattedImages","computed","img","currentSlide","onMounted","loadVideoData","error","ElMessage","data","axios","videoResponse","e","goBack","handleThumbnailClick","index","saveVideoData","updateSlideNote","requestData","response","handleSave","handleGenerate","ElMessageBox","taskId","pollTaskStatus","attempts","status","handlePreview","handleVideoDialogClose","_withDirectives","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_page_header","_component_el_button","_component_el_icon","_unref","Check","_hoisted_3","_hoisted_4","_hoisted_5","_component_el_scrollbar","_Fragment","_renderList","_normalizeClass","$event","_hoisted_8","_toDisplayString","_hoisted_9","_hoisted_10","_hoisted_12","_component_el_input","none","_hoisted_13","_hoisted_14","_component_el_button_group","VideoCamera","View","_hoisted_15","_cache","_component_el_form","_component_el_form_item","_component_el_input_number","VoiceSelector","_component_el_dialog","_hoisted_16","_hoisted_18","_component_el_empty"],"mappings":"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"}